<!DOCTYPE html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <meta name="google-site-verification" content="B1FzZc3CJZBOYCAv5w3sW5PIuX59l43HFSDFAjX2nqc" />

        <link rel="stylesheet" href="static/css/bootstrap.css">
        <link rel="stylesheet" href="static/css/gh-fork-ribbon.css">
        <style>
            body {
                padding-top: 50px;
                padding-bottom: 20px;
            }
        </style>
        <link rel="stylesheet" href="static/css/bootstrap-theme.css">
        <link rel="stylesheet" href="static/css/main.css">
        <script src="static/js/vendor/modernizr-2.6.2.js"></script>
    </head>

    <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">file-bucket</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="index.html">Home</a></li>
            <li class=""><a href="download.html">Download</a></li>
          </ul>
        </div><!--/.navbar-collapse -->
      </div>
    </div>

    
<div class="jumbotron">
  <div class="container">
    <h1>File Bucket</h1>
    <p>No-auth backup system over HTTP!</p>
  </div>
</div>

<div class="container">
  <!-- Example row of columns -->
  <div class="row">

    <div class="col-lg-7">
      <p>An http server, with write only permission for backup solution.</p>
<p>The idea is to allow clients to push backup files to centralized server over LAN, unlike other backup solution file-bucket doesn't use the classic username/password pair to auth the user but a single 32-byte long token.</p>
<p>To enhanced security each server can <strong>only</strong> write into it's own bucket, so if a server is compromised the attacker can only guess the server token but it cannot read old backups neither discover or read other server backup files.</p>
<div class="section" id="installation">
<h1>Installation</h1>
<p>To install the file-bucket on debian system you can dowload the package from <a class="reference external" href="http://claudyus.github.io/file-bucket/">http://claudyus.github.io/file-bucket/</a> install it with <tt class="docutils literal">dpkg</tt>:</p>
<pre class="literal-block">
$ wget http://claudyus.github.io/file-bucket/file-bucket_VERSION.deb
$ dpkg -i file-bucket_VERSION.deb
</pre>
<div class="section" id="configuration">
<h2>Configuration</h2>
<p>You should configure the buckets list and buckets home inside <tt class="docutils literal"><span class="pre">/etc/file-bucket/config.json</span></tt>
To override this settings you can pass <tt class="docutils literal"><span class="pre">--config</span> &lt;file&gt;</tt> as command line parameters.</p>
<p>The bucket list can also be reload using <tt class="docutils literal">SIGUSR2</tt>, please note that only changes to bucket list are effective using this method.</p>
</div>
<div class="section" id="use">
<h2>Use</h2>
<p>On your client you can simple push backup file using curl like:</p>
<pre class="literal-block">
$ curl -X POST &lt;serverip&gt;:1234/&lt;bucket_token&gt; -F file=&#64;&lt;file&gt;
</pre>
<p>The server will responde with <tt class="docutils literal">200</tt> on success or with the following errorcode are used:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">ErrorCode</th>
<th class="head">Detail</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>403</td>
<td>given token doesn't exist</td>
</tr>
<tr><td>412</td>
<td>missed file in form post</td>
</tr>
<tr><td>405</td>
<td>file yet exist on filesystem</td>
</tr>
<tr><td>401</td>
<td>cannot create bucket dirs</td>
</tr>
<tr><td>409</td>
<td>abort due to pre-push script (see below)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="extending-the-behaviour">
<h1>Extending the behaviour</h1>
<p><tt class="docutils literal"><span class="pre">file-bucket</span></tt> support a series of hooks that can be used to extend the default behaviour.
For example you can email someone when a file is pushed or deploy the file as a lxc container or the contained files in an automatic way.</p>
<p>At the moment the following hooks are defined:</p>
<ul class="simple">
<li>pre-push.sh</li>
<li>post-push.sh</li>
</ul>
<p>The <tt class="docutils literal"><span class="pre">/etc/file-bucket/pre-push.sh</span></tt> script is executed before the check of the file presence on the filesystem is executed.
This script should return <strong>0</strong> to allow the file upload, should return <strong>1</strong> to abort the upload and could return <strong>2</strong> to allow file overwrite.
This script is called with the arguments:</p>
<ul class="simple">
<li>bucket token</li>
<li>upload filename</li>
<li>file size (TODO)</li>
<li>remote ip_client:port</li>
</ul>
<p>The <tt class="docutils literal"><span class="pre">/etc/file-bucket/post-push.sh</span></tt> script is executed after the file upload and can be used to manipulate the file itself.
This script is called with the arguments:</p>
<ul class="simple">
<li>bucket token</li>
<li>complete filename with path</li>
<li>remote ip_client:port</li>
</ul>
<p>The stdout of this command is passed back to the client as http body. Http return code is than set to 200.</p>
<p><strong>Note: All hooks script should have executable flag set.</strong></p>
<div class="section" id="hooks-examples">
<h2>Hooks examples</h2>
<p>Some scripts files as example are availables inside the <tt class="docutils literal">hooks/</tt> directory.</p>
</div>
</div>
<div class="section" id="license">
<h1>LICENSE</h1>
<p>This project is released under MIT license.</p>
</div>


    </div>

    <div class="col-lg-5">
      <h2>Project stargazers</h2>
      <p><a href="https://github.com/claudyus/file-bucket" target="_blank" class="btn btn-success btn-primary"><i class="glyphicon glyphicon-star glyphicon-white"></i> Do you like the idea? Star the project!</a></p> 
      <div id="stars"></div>

      <h2>Languages</h2>
      <div id="langs">
        <canvas id="langs" width="200" height="200"></canvas>
        <ul></ul>
      </div>

      <h2>Contributors</h2>
      <div id="contributors"></div>
    </div>

    <div class="github-fork-ribbon-wrapper right">
      <div class="github-fork-ribbon">
        <a href="https://github.com/claudyus/file-bucket">Fork me on GitHub</a>
      </div>
    </div>

    <script src="static/js/vendor/jquery-1.10.1.js"></script>
    <script src="static/js/vendor/bootstrap.js"></script>
    <script src="static/js/vendor/Chart.min.js"></script>
    <script src="static/js/main.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-50997237-1', 'claudyus.github.io');
      ga('send', 'pageview');
    </script>
    
  <script>
    $( document ).ready(function() {
      $.ajax('https://api.github.com/repos/claudyus/file-bucket/stats/contributors',
        {
          success: function (data, status) {
            for (var i = data.length - 1; i >= 0; i--) {
              var author = data[i].author;
              $('#contributors').append('<div class="contributor"><img src="' + author.avatar_url + '"/>' +
                '<strong><a href="' + author.html_url + '">' + author.login + '</a></strong>' +
                '<commits><i class="glyphicon glyphicon-plus"></i>' + data[i].total + ' commits</commits></div>');
            }
          }
        });
      $.ajax('https://api.github.com/repos/claudyus/file-bucket/stargazers',
        {
          success: function (data, status) {
            for (var i = data.length - 1; i >= 0; i--) {
              var author = data[i];
              $('#stars').append('<a href="' + author.html_url + '"><img src="' + author.avatar_url + '" class="img-circle star"/></a>');
            }
          }
        });
      $.get('https://api.github.com/repos/claudyus/file-bucket/languages',
        function (data, status) {
          var ctx = $("#langs canvas").get(0).getContext("2d");
          data_graph = []
          for(var k in data) {
            col_lang = '#'+(Math.random()*0xFFFFFF<<0).toString(16)
            data_graph.push({value: data[k], color: col_lang })
            $("#langs ul").append('<li><strong>' + k + '</strong> - ' + data[k] + ' BOC</li>')
          }
          new Chart(ctx).Doughnut(data_graph, {animation : true, animationSteps: 100})
        });
    });
  </script>

  </body>
</html>
